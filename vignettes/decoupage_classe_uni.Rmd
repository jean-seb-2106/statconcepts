---
title: "decoupage_classe_uni"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{decoupage_classe_uni}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(statconcepts)
library(ggplot2)
library(dplyr)
library(kableExtra)
```

```{r}

#Création d'une fonction qui renvoie un vecteur avec les bornes de classe
calculer_bornes <- function(num,nbclass,type_decoup){
  if (type_decoup == "largeur_fixe"){
    max <- max(num)
    min <- min(num)
    largeur <- (max-min)/nbclass #largeur de chaque tranche
    bornes <- seq(min,max,largeur) #vecteur numérique avec les bornes
  }else if (type_decoup == "quantiles"){
    vect_quantiles <- seq(0,1,1/nbclass)
    bornes <- quantile(num,vect_quantiles)
  }
  return(bornes)
}

#Exemple avec grandile
x <- grandile$REV_DISPONIBLE
y <- 5
z <- "largeur_fixe"
calculer_bornes(x,y,z)

```
```{r}
# A partir du vecteur numérique avec les bornes de classe, on récupère un tableau avec les classes
tabuler_bornes <- function(num,nbclass,type_decoup){
if (type_decoup == "largeur_fixe") {
      tab <- data.frame(cbind(
        seq(1, nbclass,1),
        num[1:nbclass],
        num[2:(nbclass+1)]
      ))
      colnames(tab) <- c("tranche","borne inf","borne sup")
}else if (type_decoup == "quantiles"){
   tab <- data.frame(cbind(
        seq(0, 1, 1 / nbclass),
        num
      ))
      colnames(tab) <- c("quantile","borne")
      rownames(tab) <- NULL
}
  return(tab)
}

x <- grandile$REV_DISPONIBLE
y <- 5
z <- "quantiles"
a <- calculer_bornes(x,y,z)
b <- tabuler_bornes(a,y,z)

#Fonction qui formatte un data.frame à partir de la deuxième colonne

kbl(b,digits = c(2,0,0),format = "html")
```

```{r}
#Afficher un histogramme à partir du vecteur numérique des classes
data(grandile)
x <- grandile$REV_DISPONIBLE
y <- 5 #nombre de tranches
z <- "largeur_fixe"
zbis <- "quantiles"
a <- calculer_bornes(x,y,z)
abis <- calculer_bornes(x,y,zbis)
names(abis) <- NULL
dput(a)
dput(abis)
ggplot(grandile)+aes(REV_DISPONIBLE)+geom_histogram(bins=y,breaks=dput(a))
```



